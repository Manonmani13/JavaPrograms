
select  * from calendar_slot where id=2430

select * from calendar where id=1505
---------------------------------------------

 SELECT ci. *, vca.service_name as prev_service_name , vca.service_id  as prev_service_id, vca.appointment_number_prefix  as prev_appointment_number,
vca.service_pre_requisite as prev_service_info, vca.slot_from_time as prev_app_date, vca.slot_to_time as prev_app_end_time, vca.owner_name  as prev_owner_name 	
FROM ( select C.location_detail AS meeting_link, slot.description as slot_description,`CI`.`id` AS `id`,`CI`.`attended_date` AS `attended_date`,`CI`.`registered_date` AS `registered_date`,`CI`.`calendar_id` AS `calendar_id`,`CI`.`calendar_slot_id` AS `calendar_slot_id`,`CI`.`user_id` AS `user_id`,`CI`.`user_type` AS `user_type`,`CI`.`is_coordinator` AS `is_coordinator`,`CI`.`invitee_status` AS `invitee_status`,`CI`.`reminder_date` AS `reminder_date`,`CI`.`reminder_sent` AS `reminder_sent`,`CI`.`attended` AS `attended`,`CI`.`rating` AS `rating`,`CI`.`feedback` AS `feedback`,`CI`.`updated_at` AS `updated_at`,`CI`.`created_by` AS `created_by`,`CI`.`updated_by` AS `updated_by`,`CI`.`created_at` AS `created_at`,`CI`.`linked_appointment_ids` AS `linked_appointment_ids`,`CI`.`linked_ticket_id` AS `linked_ticket_id`,`CI`.`created_by` AS `is_owner`,`CI`.`application_id` AS `application_id`,`CI`.`reason_id` AS `reason_id`,`CI`.`subject` AS `subject`,`CI`.`purpose_meeting` AS `purpose_meeting`,`CI`.`reason_desc` AS `reason_desc`,`CI`.`program_id` AS `program_id`,`CT`.`name` AS `type`,`CI`.`form_details_id` AS `form_details_id`,`CI`.`confirm_arrival` AS `confirm_arrival`,`CI`.`booking_form_required` AS `booking_form_required`,`CI`.`advisor_id` AS `advisor_id`,`CI`.`dropin_status` AS `dropin_status`,`CI`.`dropin_number` AS `dropin_number`,`CI`.`start_time` AS `start_time`,`CI`.`end_time` AS `end_time`,`CI`.`hold_dropin` AS `hold_dropin`,`CI`.`hold_time` AS `hold_time`,`CI`.`award_id` AS `award_id`,`CI`.`flag_id` AS `flag_id`,`ca`.`name` AS `award_name`,`ca`.`image_url` AS `award_image`,`C`.`start_date` AS `start_date`,`C`.`end_date` AS `end_date`,`CI`.`qr_code` AS `qr_code`,`C`.`service_id` AS `service_id`,`C`.`description` AS `description`,`C`.`calendar_image_url` AS `calendar_image_url`,`comm`.`profile_pic_url` AS `advisor_profile_pic_url`,`CU`.`profile_pic_url` AS `invitee_profile_pic_url`,`comm`.`name` AS `advisor_name`,ifnull(`CU`.`name`,concat(`SUS`.`first_name`,' ',`SUS`.`last_name`)) AS `name`,`CU`.`mobile` AS `mobile`,ifnull(`CU`.`email`,`SUS`.`email_id`) AS `email`,`slot`.`slot_from_time` AS `slot_from_time`,`slot`.`slot_to_time` AS `slot_to_time`,`C`.`booking_form_id` AS `booking_form_id`,`C`.`user_id` AS `owner_id`,`C`.`status` AS `calendar_status`,`loc`.`short_name` AS `location`,`slot`.`slot_campus` AS `campus_name`,`room`.`short_name` AS `room_name`,`C`.`name` AS `calendar_name`,`ca_service`.`email_id` AS `email_id`,`ca_service`.`signature` AS `signature`,`ca_service`.`description` AS `service_description`,`ca_service`.`pre_requisite` AS `service_pre_requisite`,`CI`.`prev_calendar_slot_id` AS `prev_calendar_slot_id`,`CI`.`mode_of_invitee` AS `mode_of_invitee`,`CI`.`current_waiting_list` AS `current_waiting_list`,`CI`.`waiting_list` AS `waiting_list`,`CUU`.`name` AS `owner_name`,`ca_service`.`name` AS `service_name`,'' AS `academic_year`,`appc`.`area` AS `Program_name`,group_concat(`appc`.`program` separator ',') AS `course_name`,`stud`.`student_id` AS `student_number`,(case when isnull(`ca_service`.`appointment_prefix`) then `CI`.`id` else concat(`ca_service`.`appointment_prefix`,'-',`CI`.`id`) end) AS `appointment_number_prefix`,(case when isnull(`ca_service`.`appointment_prefix`) then `CI`.`dropin_number` else concat(`ca_service`.`appointment_prefix`,'-',`CI`.`dropin_number`) end) AS `dropin_number_prefix`,(case when isnull(`ca_service`.`appointment_prefix`) then `CI`.`id` else concat(`ca_service`.`appointment_prefix`,'-',`CI`.`id`) end) AS `appointment_number`,`slot`.`name` AS `slot_name`,`subjects`.`short_name` AS `subjects`  from ((((((((((((((select * from `calendar_invitees` where calendar_slot_id = 1070 ) `CI` left join `calendar` `C` on((`CI`.`calendar_id` = `C`.`id`))) LEFT JOIN `calendar_types` `CT` ON ( ( `C`.`type_id` = `CT`.`id` ) ) left join `calendar_slot` `slot` on((`CI`.`calendar_slot_id` = `slot`.`id`))) left join `masterlookup` `loc` on((`slot`.`slot_location_id` = `loc`.`id`))) left join `masterlookup` `room` on((`slot`.`slot_room_id` = `room`.`id`))) left join `community_user_profiles` `CU` on(((`CI`.`user_id` = `CU`.`user_id`) and (`CI`.`user_type` <> 'suspect')))) left join `calendar_service` `ca_service` on((`C`.`service_id` = `ca_service`.`id`))) left join `vw_students` `stud` on((`CI`.`user_id` = `stud`.`user_id`))) left join `community_user_profiles` `CUU` on(((`C`.`user_id` = `CUU`.`user_id`) and (`CI`.`user_type` <> 'suspect')))) left join `lead_datasource_details` `SUS` on(((`CI`.`user_id` = `SUS`.`id`) and (`CI`.`user_type` = 'suspect')))) LEFT JOIN `masterlookup` `subjects` ON `subjects`.`id` = `SUS`.`subject_area` left join `masterlookup` `program` on((`CI`.`program_id` = `program`.`id`))) left join `vw_app_course` `appc` on(find_in_set(`appc`.`id`,`CI`.`linked_appointment_ids`))) left join `community_user_profiles` `comm` on((`CI`.`advisor_id` = `comm`.`user_id`))) left join `calendar_award` `ca` on((`CI`.`award_id` = `ca`.`id`))) group by `CI`.`id` ) ci LEFT OUTER JOIN ( select C.location_detail AS meeting_link, slot.description as slot_description,`CI`.`id` AS `id`,`CI`.`attended_date` AS `attended_date`,`CI`.`registered_date` AS `registered_date`,`CI`.`calendar_id` AS `calendar_id`,`CI`.`calendar_slot_id` AS `calendar_slot_id`,`CI`.`user_id` AS `user_id`,`CI`.`user_type` AS `user_type`,`CI`.`is_coordinator` AS `is_coordinator`,`CI`.`invitee_status` AS `invitee_status`,`CI`.`reminder_date` AS `reminder_date`,`CI`.`reminder_sent` AS `reminder_sent`,`CI`.`attended` AS `attended`,`CI`.`rating` AS `rating`,`CI`.`feedback` AS `feedback`,`CI`.`updated_at` AS `updated_at`,`CI`.`created_by` AS `created_by`,`CI`.`updated_by` AS `updated_by`,`CI`.`created_at` AS `created_at`,`CI`.`linked_appointment_ids` AS `linked_appointment_ids`,`CI`.`linked_ticket_id` AS `linked_ticket_id`,`CI`.`created_by` AS `is_owner`,`CI`.`application_id` AS `application_id`,`CI`.`reason_id` AS `reason_id`,`CI`.`subject` AS `subject`,`CI`.`purpose_meeting` AS `purpose_meeting`,`CI`.`reason_desc` AS `reason_desc`,`CI`.`program_id` AS `program_id`,`CT`.`name` AS `type`,`CI`.`form_details_id` AS `form_details_id`,`CI`.`confirm_arrival` AS `confirm_arrival`,`CI`.`booking_form_required` AS `booking_form_required`,`CI`.`advisor_id` AS `advisor_id`,`CI`.`dropin_status` AS `dropin_status`,`CI`.`dropin_number` AS `dropin_number`,`CI`.`start_time` AS `start_time`,`CI`.`end_time` AS `end_time`,`CI`.`hold_dropin` AS `hold_dropin`,`CI`.`hold_time` AS `hold_time`,`CI`.`award_id` AS `award_id`,`CI`.`flag_id` AS `flag_id`,`ca`.`name` AS `award_name`,`ca`.`image_url` AS `award_image`,`C`.`start_date` AS `start_date`,`C`.`end_date` AS `end_date`,`CI`.`qr_code` AS `qr_code`,`C`.`service_id` AS `service_id`,`C`.`description` AS `description`,`C`.`calendar_image_url` AS `calendar_image_url`,`comm`.`profile_pic_url` AS `advisor_profile_pic_url`,`CU`.`profile_pic_url` AS `invitee_profile_pic_url`,`comm`.`name` AS `advisor_name`,ifnull(`CU`.`name`,concat(`SUS`.`first_name`,' ',`SUS`.`last_name`)) AS `name`,`CU`.`mobile` AS `mobile`,ifnull(`CU`.`email`,`SUS`.`email_id`) AS `email`,`slot`.`slot_from_time` AS `slot_from_time`,`slot`.`slot_to_time` AS `slot_to_time`,`C`.`booking_form_id` AS `booking_form_id`,`C`.`user_id` AS `owner_id`,`C`.`status` AS `calendar_status`,`loc`.`short_name` AS `location`,`slot`.`slot_campus` AS `campus_name`,`room`.`short_name` AS `room_name`,`C`.`name` AS `calendar_name`,`ca_service`.`email_id` AS `email_id`,`ca_service`.`signature` AS `signature`,`ca_service`.`description` AS `service_description`,`ca_service`.`pre_requisite` AS `service_pre_requisite`,`CI`.`prev_calendar_slot_id` AS `prev_calendar_slot_id`,`CI`.`mode_of_invitee` AS `mode_of_invitee`,`CI`.`current_waiting_list` AS `current_waiting_list`,`CI`.`waiting_list` AS `waiting_list`,`CUU`.`name` AS `owner_name`,`ca_service`.`name` AS `service_name`,'' AS `academic_year`,`appc`.`area` AS `Program_name`,group_concat(`appc`.`program` separator ',') AS `course_name`,`stud`.`student_id` AS `student_number`,(case when isnull(`ca_service`.`appointment_prefix`) then `CI`.`id` else concat(`ca_service`.`appointment_prefix`,'-',`CI`.`id`) end) AS `appointment_number_prefix`,(case when isnull(`ca_service`.`appointment_prefix`) then `CI`.`dropin_number` else concat(`ca_service`.`appointment_prefix`,'-',`CI`.`dropin_number`) end) AS `dropin_number_prefix`,(case when isnull(`ca_service`.`appointment_prefix`) then `CI`.`id` else concat(`ca_service`.`appointment_prefix`,'-',`CI`.`id`) end) AS `appointment_number`,`slot`.`name` AS `slot_name`,`subjects`.`short_name` AS `subjects`  from ((((((((((((((select * from `calendar_invitees` where calendar_slot_id = 1070 ) `CI` left join `calendar` `C` on((`CI`.`calendar_id` = `C`.`id`))) LEFT JOIN `calendar_types` `CT` ON ( ( `C`.`type_id` = `CT`.`id` ) ) left join `calendar_slot` `slot` on((`CI`.`calendar_slot_id` = `slot`.`id`))) left join `masterlookup` `loc` on((`slot`.`slot_location_id` = `loc`.`id`))) left join `masterlookup` `room` on((`slot`.`slot_room_id` = `room`.`id`))) left join `community_user_profiles` `CU` on(((`CI`.`user_id` = `CU`.`user_id`) and (`CI`.`user_type` <> 'suspect')))) left join `calendar_service` `ca_service` on((`C`.`service_id` = `ca_service`.`id`))) left join `vw_students` `stud` on((`CI`.`user_id` = `stud`.`user_id`))) left join `community_user_profiles` `CUU` on(((`C`.`user_id` = `CUU`.`user_id`) and (`CI`.`user_type` <> 'suspect')))) left join `lead_datasource_details` `SUS` on(((`CI`.`user_id` = `SUS`.`id`) and (`CI`.`user_type` = 'suspect')))) LEFT JOIN `masterlookup` `subjects` ON `subjects`.`id` = `SUS`.`subject_area` left join `masterlookup` `program` on((`CI`.`program_id` = `program`.`id`))) left join `vw_app_course` `appc` on(find_in_set(`appc`.`id`,`CI`.`linked_appointment_ids`))) left join `community_user_profiles` `comm` on((`CI`.`advisor_id` = `comm`.`user_id`))) left join `calendar_award` `ca` on((`CI`.`award_id` = `ca`.`id`))) group by `CI`.`id` ) vca  on ci.prev_calendar_slot_id = vca.calendar_slot_id  where ci.calendar_slot_id = 1070

